port of core elements from previous KC_LIB
